 spring.application.name=ai-agent

# WebFlux 配置
server.port=8080

# Netty 服务器配置
server.netty.connection-timeout=20s
server.netty.idle-timeout=60s

# Knife4j 已禁用（不支持 WebFlux）
# springdoc.swagger-ui.path=/swagger-ui.html
# springdoc.swagger-ui.tags-sorter=alpha
# springdoc.swagger-ui.operations-sorter=alpha

# springdoc.api-docs.path=/v3/api-docs

# springdoc.group-configs[0].group=default
# springdoc.group-configs[0].paths-to-match=/**
# springdoc.group-configs[0].packages-to-scan=com.shawn.aiagent.controller

# knife4j.enable=true
# knife4j.setting.language=zh_cn

# ========== 日志配置 ==========
# 日志级别
logging.level.root=INFO
logging.level.com.shawn.aiagent=DEBUG

# 日志文件路径
logging.file.path=./logs
logging.file.name=./logs/ai-agent.log

# 日志格式
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n

# 日志文件配置
logging.logback.rollingpolicy.max-file-size=100MB
logging.logback.rollingpolicy.max-history=30
logging.logback.rollingpolicy.total-size-cap=3GB

# AI API 配置
spring.ai.dashscope.api-key=sk-160d7a7512184ab3bb899b08a42c43e7
spring.ai.dashscope.chat.options.model=qwen-plus
spring.ai.dashscope.embedding.options.model=text-embedding-v4

# ========== PostgreSQL + pgvector 向量数据库配置 ==========
# PostgreSQL 数据库连接配置
spring.datasource.url=jdbc:postgresql://localhost:5432/dreamdb
spring.datasource.username=dream
spring.datasource.password=dream123
spring.datasource.driver-class-name=org.postgresql.Driver

# pgvector 向量存储配置
# text-embedding-v4 模型的维度是 1024
spring.ai.vectorstore.pgvector.embedding-dimension=1024

# 是否在启动时自动创建表结构（建议开发期开启）
spring.ai.vectorstore.pgvector.initialize-schema=true

# 表名称（建议"一个模型一个表"）
spring.ai.vectorstore.pgvector.table-name=dreams_chunks_text_embedding_v4

# 索引类型：HNSW 或 IVFFLAT（HNSW 性能更好但占用空间更大）
spring.ai.vectorstore.pgvector.index-type=HNSW

# HNSW 索引参数（仅当 index-type=HNSW 时生效）
spring.ai.vectorstore.pgvector.hnsw.m=16
spring.ai.vectorstore.pgvector.hnsw.ef-construction=64

# ========== RAG 数据摄取配置 ==========
# 批量加载时的批次大小（每批处理的文档数量）
rag.ingestion.batch-size=100

# 每批加载的超时时间（秒）
rag.ingestion.batch-timeout-seconds=300